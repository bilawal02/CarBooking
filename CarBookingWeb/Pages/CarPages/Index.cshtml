@page
@model CarBookingWeb.Pages.CarPages.IndexModel
@{
    <div class="row">
        <div class="col-md-6"><h2>List of Cars</h2></div>
        <div class="col-md-6"> <a asp-page="/CarPages/Create" class="btn btn-primary"><i class="fa-solid fa-plus"></i> Create New</a></div>
    </div>

    <br />

    <table class="table">
        <thead>
            <tr>
                <th>@Html.DisplayNameFor(model => model.Cars[0].CarMaker.Name)</th>
                <th>@Html.DisplayNameFor(model => model.Cars[0].CarModel.Name)</th>
                <th>@Html.DisplayNameFor(model => model.Cars[0].CarColor.Name)</th>
                <th>@Html.DisplayNameFor(model => model.Cars[0].Year)</th>
                <th>@Html.DisplayNameFor(model => model.Cars[0].LicensePlateNumber)</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Cars)
            {
                <tr>
                    <td>@item.CarMaker.Name</td>
                    <td>@item.CarModel.Name</td>
                    <td>@item.CarColor.Name</td>
                    <td>@item.Year</td>
                    <td>@item.LicensePlateNumber</td>
                    <td>
                        @*<a asp-page="/CarPages/Details" asp-route-carId="@item.Id" class="btn btn-info"><i class="fa-solid fa-book-open"></i> Details</a> |
                        <a asp-page="/CarPages/Edit" asp-route-carId="@item.Id" class="btn btn-warning"><i class="fa-solid fa-pen-to-square"></i> Edit</a> |
                        <button class="btn btn-danger confirmDelete" data-id="@item.Id"><i class="fa-solid fa-trash"></i> Delete</button>*@
                        @await Html.PartialAsync("_Buttons",item.Id)
                    </td>
                </tr>
            }
        </tbody>
    </table>
    // <form method="post" asp-page-handler="Delete" id="myCarDeleteForm">
    //     <input type="hidden" name="carId" id="carId" />
    // </form>
    <partial name="_DeleteForm" />

    @section Scripts {
        <script src="~/js/DeleteButton.js"></script>
        //<script>
        //     $(function () {
        //         $(".confirmDelete").click(function (e) {
        //             swal({
        //                 title: 'Are you sure?',
        //                 text: "You won't be able to revert this!",
        //                 icon: 'warning',
        //                 buttons: true,
        //                 dangerMode: true
        //             }).then((result) => {
        //                 if (result) {
        //                     var btn = $(this);
        //                     var id = btn.data("id");
        //                     $("#carId").val(id);
        //                     $('#myCarDeleteForm').submit();
        //                 }
        //             });
        //         });
        //     });
        // </script>
    }
}


@*
yeh correct hy
<a asp-page="/CarPages/Details" asp-route-carId="@item.CarId" class="btn btn-info">Details</a> |
<a asp-page="/CarPages/Edit" asp-route-carId="@item.CarId" class="btn btn-warning">Edit</a> |
<a asp-page="/CarPages/Delete" asp-route-carId="@item.CarId" class="btn btn-danger">Delete</a> |
<form method="post" asp-page-handler="Delete" asp-route-carId="@item.CarId">
    <button class="btn btn-danger" onclick="return confirm('Are you sure you want to Delete this?')">Delete By Confirm</button>
</form>


yeh Fetch aur AJAX k liye hy...jo k kam nhi kr rha
<form method="post">
<a asp-page="/CarPages/Details" asp-route-carId="@item.CarId" class="btn btn-info">Details</a> |
<a asp-page="/CarPages/Edit" asp-route-carId="@item.CarId" class="btn btn-warning">Edit</a> |
<button class="btn btn-danger" onclick="deleteCar(@item.CarId)">Delete By Confirm</button>
</form>


yeh correct hy
<form method="post" asp-page-handler="Delete" asp-route-carId="@item.CarId">
<a asp-page="/CarPages/Details" asp-route-carId="@item.CarId" class="btn btn-info">Details</a> |
<a asp-page="/CarPages/Edit" asp-route-carId="@item.CarId" class="btn btn-warning">Edit</a> |
<button class="btn btn-danger" onclick="return confirm('Are you sure you want to Delete this?')">Delete By Confirm</button>
</form> *@

@* @section Scripts {
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script>
        // function deleteCar(carId) {
        //     if (confirm('Are you sure you want to delete this car?')) {
        //         fetch(`/CarPages?handler=Delete`, {
        //             method: 'POST',
        //             headers: {
        //                 'Content-Type': 'application/x-www-form-urlencoded',
        //             },
        //             body: `carId=${carId}`,  // Send carId in the request body
        //         })
        //             .then(response => response.json())
        //             .then(data => {
        //                 if (data.success) {
        //                     console.log(data);
        //                 } else {
        //                     // Handle deletion failure
        //                     console.log("Error Occur");
        //                 }
        //             });
        //     }
        // }



        // $(document).ready(function () {
        //     $('.deleteConfirmBtn').click(function () {
        //         var carId = $(this).data('car-id');
        //         console.log(carId);
        //         // Make AJAX request to delete the record
        //         $.ajax({
        //             type: 'POST',
        //             url: `/CarPages/Index?handler=Delete`,
        //             data: { carId: carId },
        //             contentType: 'application/json; charset=utf-8',
        //             dataType: "json",
        //             success: function (response) {
        //                 // Update the UI (remove the deleted record)
        //                 // $('#car-row-' + carId).remove();
        //                 console.success('Record Deleted: ', response);
        //             },
        //             error: function (error) {
        //                 console.error('Error deleting record:', error);
        //             }
        //         });
        //     });
        // });
    </script>
} *@


@*   https://localhost:7182/CarPages/Delete?carId=3
                    https://localhost:7182/CarPages?carId=4&handler=Delete *@
